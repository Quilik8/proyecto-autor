# Manual del Proyecto A.U.T.O.R.
**Última actualización:** [Fecha de hoy]

---

## Parte 1: La Visión

### Filosofía y Propósito Central

El proyecto se llama **A.U.T.O.R.**, un acrónimo que define nuestros pilares:

-   **A**utonomía: El creador tiene control total sobre su obra y cómo la monetiza.
-   **U**niversal: Accesible para cualquier creador de cualquier parte del mundo. Empezamos en español, pero con visión global.
-   **T**alento: La plataforma está diseñada para recompensar el talento y el esfuerzo, no solo la popularidad previa.
-   **O**bras: El foco es la calidad y la diversidad de las obras, desde novelas seriadas hasta ensayos, y en el futuro, otros formatos.
-   **R**egalías: Un sistema de monetización transparente y justo es el núcleo del proyecto.

**El propósito** es simple: crear el "YouTube/Twitch de los escritores". Un lugar donde cualquiera pueda empezar a construir una carrera escribiendo, con herramientas de monetización y comunidad integradas desde el día uno.

### Visión a Largo Plazo y Fases de Expansión

El proyecto evolucionará en fases, expandiendo el tipo de contenido y las funcionalidades:

1.  **Fase Texto (Actual):** El MVP se centra en la ficción seriada y textos largos. El objetivo es consolidar la comunidad de lectores y escritores.
2.  **Fase Ecosistema ("El Gremio"):**
    *   **Mercado de Talentos:** Crear perfiles verificados para **Editores, Diseñadores, Traductores, etc.**
    *   **Colaboración Integrada:** Permitir a los autores contratar y colaborar con estos profesionales dentro de la plataforma.
    *   **Reparto de Ganancias Automatizado:** Un autor y un diseñador podrían acordar un reparto del 5% para la portada, y la plataforma gestionaría los pagos automáticamente.
    *   **Visión del Gremio Unificado:** El Gremio no será exclusivo de `AUTOR.WRITING`. Está concebido como un ecosistema transversal y compartido. Un autor en `.WRITING` podrá buscar y contratar a un ilustrador de `AUTOR.ART` para una portada, o a un compositor de `AUTOR.AUDIO` para un audiolibro. Los perfiles, reputación y sistema de contratos serán universales, creando una red de colaboración creativa sin precedentes.

3.  **Fase Multimedia:**
    *   **Audio:** Integración para audiolibros y podcasts narrativos.
    *   **Imagen:** Soporte para cómics, novelas ilustradas y galerías de arte conceptual.
    *   **Video:** Alojamiento de book-trailers, entrevistas con autores o cursos.

### Modelo de Negocio y Monetización Detallado

A.U.T.O.R. ofrecerá un conjunto flexible de herramientas de monetización para que el autor elija:

-   **Publicidad (Estilo YouTube):** Anuncios no intrusivos mostrados durante la lectura. Los ingresos se reparten entre la plataforma y el autor.
-   **Suscripción (Estilo Medium/Netflix):** Los lectores pagan una cuota mensual para una experiencia sin anuncios y acceso a contenido premium. Los ingresos de la suscripción se reparten entre los autores cuyas obras leen.
-   **Compra Directa (Paywall Flexible):**
    *   **Comprar la Obra Completa:** Pagar una vez para tener acceso perpetuo y sin anuncios a una historia.
    *   **Pago por Capítulo (Paywall Rodante):** El autor puede decidir que los últimos 1-3 capítulos sean de pago, y se vuelven gratuitos a medida que publica nuevos. Esto incentiva el apoyo de los fans más leales.
-   **Donaciones y Apoyo Directo (Estilo Patreon/Twitch):**
    *   **Donación por Párrafo:** Una "killer feature" donde los lectores pueden dejar una pequeña donación en un párrafo específico que les encantó.
    *   **Metas de Donación:** Los autores pueden establecer metas públicas (ej. "A los $100, publico un capítulo extra") para incentivar el apoyo comunitario.
    *   **Niveles de Mecenazgo:** Donaciones mensuales a cambio de recompensas definidas por el autor (acceso anticipado, menciones, contenido exclusivo).

### Gamificación y Retención de Usuarios

Para hacer la plataforma más atractiva y fomentar la participación:

-   **Para Lectores:** Ganar una "moneda virtual" por leer, entrar diariamente o ver anuncios, que luego pueden usar para donar o desbloquear contenido. Insignias por logros (terminar una saga, ser el primer donante, etc.).
-   **Para Autores:** "Misiones" para guiar su crecimiento ("Publica tu primera historia", "Consigue 10 seguidores") y recompensas por hitos de ingresos o publicación. El reparto de ganancias podría mejorar a medida que el autor crece en la plataforma.

- El objetivo es crear un ciclo de participación gratificante. Los lectores realizan acciones en la plataforma, ganan XP (Puntos de Experiencia) para su "Árbol de Progreso" y Monedas (la divisa virtual de la plataforma) para gastar.

**Acciones que Generan Recompensas (XP y Monedas):**

*   **Lectura Activa:**
- Completar un capítulo.
- Completar una historia completa (bonificación grande).
- Rachas de lectura (leer al menos un capítulo diario/semanal).

*   **Participación Comunitaria:**
- Dejar un comentario en un capítulo.
- Recibir "me gusta" en un comentario propio.
- Escribir una reseña/crítica detallada de una obra.
- Iniciar un hilo de discusión en el foro.
- Participar activamente en hilos del foro.

*   **Apoyo a Creadores:**
- Ser uno de los primeros lectores de un nuevo capítulo.
- Donar a un autor (otorga una bonificación de XP/Monedas - y dependiendo del tipo, cantidad, y reularidad de la donacion darle mas XP/Monedad).

*   **Tareas y Eventos:**
- Completar "misiones" semanales (ej. "Lee 3 capítulos de ciencia ficción").
- Participar en eventos de lectura o concursos.
- Ver anuncios opcionales.

**##Recompensas y Beneficios Desbloqueables##**
Los lectores pueden usar sus Monedas o dinero real para adquirir una variedad de mejoras.

*   **1. Estética y Estatus Social (Comprables con Monedas):**
Estos beneficios se centran en la personalización y la visibilidad dentro de la comunidad.

**Marcos de Avatar:** Bordes decorativos para la foto de perfil que se muestra en los comentarios y el foro.
**Insignias de Perfil:** Emblemas que se pueden exhibir en el perfil para mostrar logros (ej. "Fundador", "Maestro de la Fantasía", "Crítico Consagrado").
**Comentarios Destacados:** Un objeto consumible que permite al lector poner un borde brillante o un fondo de color a uno de sus comentarios para que destaque en la sección.
Títulos de Usuario: Un pequeño texto que aparece debajo de su nombre en el foro (ej. "Lector Voraz", "Teórico de Nebulon").

*   **2. Beneficios Funcionales (Desbloqueables)**
Estos mejoran la experiencia de uso de la plataforma.

**Tokens de Lectura Anticipada:**
Cómo se obtienen: Se pueden comprar en paquetes con Monedas o con dinero real.
Uso: Permiten al lector saltarse el "Paywall Rodante" y leer un capítulo de pago de forma gratuita. Un token por un capítulo.

**Paquetes de Descuento:**
Cómo se obtienen: Comprables con Monedas.
Uso: Ofrecen un % de descuento (ej. 10%) en la próxima compra de una obra completa con dinero real.

*   **3. La Biblioteca: Funciones Gratuitas vs. Premium**
La biblioteca es una herramienta central para todos, pero con una capa "premium" para los usuarios más dedicados.

**Funcionalidad Gratuita (Biblioteca Estándar - para todos los usuarios):**

**Guardar Obras:** Añadir cualquier historia a tu biblioteca personal.
**Seguimiento de Progreso:** La plataforma recuerda automáticamente en qué capítulo y párrafo te quedaste.
**Listas de Lectura Básicas:** Crear listas simples para organizar obras (ej. "Para Leer", "Favoritos").
**Notificaciones:** Recibir alertas cuando un autor que sigues publica un nuevo capítulo.
**Funcionalidad Premium (Biblioteca A.U.T.O.R.+ - desbloqueable):**

*   **Formas de Desbloqueo:**

**Suscripción Mensual:** Acceso mientras la suscripción esté activa.
**Pase Perpetuo (Pago único):** Un pago con dinero real para desbloquear las funciones premium para siempre, o con moneda gratuita pero la cantidad debe ser exhorbitante.
**Pase Temporal (Monedas):** Usar una gran cantidad de Monedas para desbloquear las funciones premium durante un tiempo limitado (ej. 30 días).

*   **Funciones Desbloqueadas:**

**Colecciones Avanzadas:** Crear estanterías visuales y personalizables, con portadas y descripciones propias.
**Estadísticas de Lectura Detalladas:** Gráficos sobre tus hábitos: géneros más leídos, autores favoritos, velocidad de lectura, etc.
**Notas y Resaltados Privados:** La capacidad de resaltar texto dentro de un capítulo y añadir notas privadas que solo tú puedes ver.
**Sincronización Offline (PWA):** Descargar un número limitado de historias para leerlas sin conexión a internet.
**Búsqueda y Filtros Avanzados:** Buscar dentro de tu propia biblioteca por notas, personajes o palabras clave.

Estas recompensas pueden desbloquearse con Pases de Acceso (comprados con una gran cantidad de Monedas o dinero real) o usando Consumibles (objetos de un solo uso comprados con Monedas).

Categoría 1: Acceso a Contenido y Discusión Exclusiva

Acceso a la "Sala de World-Building" del Autor: Un autor puede crear un foro privado temporal para su obra. Solo los poseedores de un "Pase de Mecenas" (obtenido por donación o compra) pueden entrar para discutir teorías, ver arte conceptual inédito y hablar directamente con el creador sobre el lore.

Entrada al "Círculo de Beta-Readers": Un foro exclusivo a nivel de plataforma para los usuarios más dedicados y con mejores reseñas. Para entrar, se requiere una insignia de "Crítico Consagrado" (ganada por XP) y pagar una cuota de Monedas. Los autores pueden publicar aquí capítulos en borrador para recibir feedback de alta calidad.

Acceso a Seminarios del Gremio: Editores, diseñadores o traductores del Gremio pueden organizar charlas o talleres en salas privadas. El acceso se compra con un "Ticket de Seminario" (disponible en la tienda de Monedas).

Categoría 2: Funcionalidades Avanzadas en la Comunidad

Poder de "Fijar Hilo": Un objeto consumible que permite a un usuario fijar su propio hilo de discusión en la parte superior de un foro durante 24 horas. Ideal para teorías importantes o guías creadas por fans.

Creación de Encuestas Avanzadas: La mayoría de usuarios puede crear encuestas simples. Los usuarios con un "Pase Comunitario" pueden crear encuestas con más opciones, lógica condicional o votación ponderada, ideal para debates complejos.

Firma de Perfil Personalizable: Una función premium (desbloqueada con la Biblioteca A.U.T.O.R.+) que permite a los usuarios añadir una firma con imágenes, insignias y enlaces al final de todos sus posts en el foro.

Categoría 3: Influencia y Poder Comunitario

Rol de "Embajador de Género": No se compra, sino que se otorga a los usuarios con más XP en un género específico (ej. "Embajador de la Ciencia Ficción"). Este rol les da un título único y la capacidad de moderar (marcar como inapropiado, sugerir fijar hilos) en los foros de su género.

Voto en Eventos de la Plataforma: Los usuarios con la suscripción A.U.T.O.R.+ o que hayan alcanzado un cierto nivel de XP tienen un voto en decisiones comunitarias, como "¿Cuál debería ser el tema del próximo concurso de escritura?" o "¿Qué autor clásico deberíamos destacar este mes?".

### Contenido Dinámico y Editorial: La Bitácora del Creador

Para expandir A.U.T.O.R. más allá de las obras de formato largo y crear un ecosistema de contenido más rico, se introduce el concepto de **"La Bitácora"**. Esta funcionalidad dota a cada creador (no solo autores, sino también críticos, editores, etc.) de un espacio editorial propio, similar a un blog personal integrado en su perfil.

La Bitácora permite la creación de dos formatos de contenido distintos:

1.  **Apuntes:**
    *   **Propósito:** Contenido corto y de interacción rápida. Ideal para anuncios, ideas fugaces, preguntas a la comunidad, o compartir enlaces.
    *   **Estructura:** Un cuerpo de texto con un límite de caracteres generoso.
    *   **Visualización:** Se muestra de forma completa en el feed de la Bitácora.

2.  **Artículos:**
    *   **Propósito:** Contenido de formato largo, estructurado y de mayor profundidad. Perfecto para críticas, reseñas, columnas de opinión, ensayos o capítulos únicos.
    *   **Estructura:** Requiere un **Título** y un **Cuerpo de texto** sin límite. Opcionalmente, puede incluir una imagen de cabecera.
    *   **Visualización:** En el feed de la Bitácora, se muestra una tarjeta con el título, un extracto y un botón de "Leer más...". Al hacer clic, se abre una página de lectura dedicada y libre de distracciones.

**Beneficios Estratégicos:**

*   **Empodera a todos los Roles:** Le da a un **Crítico** la herramienta adecuada para sus reseñas y a un **Autor** un canal para sus anuncios, todo dentro del mismo sistema.
*   **Aumenta el Valor de la Plataforma:** Atrae y retiene talento más allá de los novelistas, como periodistas, ensayistas y expertos del sector.
*   **Nuevas Vías de Monetización:** La distinción de formato facilita la monetización futura. Un "Artículo" premium de un experto podría ser de pago, mientras que los "Apuntes" pueden recibir propinas o "aplausos".
*   **Mejora la Comunidad:** Centraliza la conversación y el contenido editorial dentro de A.U.T.O.R., creando una experiencia más completa para el lector.

### Flujos de Usuario Clave

**1. Flujo de Nuevo Usuario (Registro y Primera Lectura):**
   - Un usuario llega a `index.html`.
   - Hace clic en "Registrarse" y va a `registro.html`.
   - Rellena el formulario, se crea la cuenta en Supabase y es redirigido a `confirmacion.html`.
   - El usuario va a su email, confirma su cuenta y vuelve a la web.
   - Ahora hace clic en "Iniciar Sesión" y va a `login.html`.
   - Introduce sus credenciales, se valida con Supabase y es redirigido a `index.html` con la sesión iniciada.
   - Navega a `explorar.html`, hace clic en una historia y llega a `historia.html`.
   - Hace clic en un capítulo y finalmente llega a `capitulo.html` para leer.

**2. Flujo de Perfil de Usuario (Vista Híbrida):**
   - El sistema de perfiles ahora opera bajo un modelo híbrido utilizando un único archivo (`perfil.html`).
   - **Vista Pública:** Cualquier usuario puede navegar a `perfil.html?id=[ID_DE_USUARIO]`. El script detectará que no es el dueño del perfil y cargará únicamente la información pública (nombre, bio, roles, obras publicadas, bitácora). Las pestañas y botones de gestión ("Gestión", "Editar Perfil", "Mi Biblioteca", botones de borrado) se ocultan por defecto y nunca se muestran.
   - **Vista Privada (Panel de Control):** Cuando un usuario inicia sesión y navega a "Mi Perfil" (o a `perfil.html` sin un ID en la URL), el script detecta que es el dueño. En este caso, muestra todos los elementos de gestión y carga los datos privados necesarios, como la lista de historias para el panel de gestión. Este enfoque evita el "parpadeo" de la interfaz y es seguro, ya que los datos privados nunca se solicitan para la vista pública.

**3. Flujo de Creación de Contenido (Bitácora):**
   - Desde su panel de gestión, el creador puede acceder a `crear-entrada.html`.
   - En esta página, elige entre dos formatos de contenido: "Apunte" (corto, sin título) o "Artículo" (largo, con título).
   - La interfaz se adapta a su elección, y la entrada se guarda en la nueva tabla `bitácora` de la base de datos.

**4. Flujo de Colaboración (Visión Futura - El Gremio):**
   - **Descubrimiento:** Un "Autor" necesita una portada para su nueva historia. Navega a la sección "El Gremio" de la plataforma y utiliza los filtros para buscar perfiles con el rol de "Diseñador". Puede filtrar por especialidad, reputación o coste.
   - **Contacto y Negociación:** El Autor revisa varios portafolios y encuentra un Diseñador que le gusta. A través de la mensajería interna de A.U.T.O.R., le envía una propuesta de trabajo. En esta propuesta, puede ofrecer un pago fijo o un porcentaje de las regalías futuras de la obra (ej. "Te ofrezco el 5% de todas las ganancias de 'Los Ecos de Nebulon' a cambio de la portada").
   - **Acuerdo y Colaboración:** El Diseñador acepta la oferta. Se genera un "contrato simplificado" en la plataforma que ambos confirman. A partir de este momento, el Diseñador obtiene permisos de acceso limitados a la página de `gestionar-historia.html` de esa obra, permitiéndole subir y gestionar la imagen de la portada, pero sin poder editar capítulos o la sinopsis.
   - **Entrega y Pago Automatizado:** Una vez que el Autor aprueba la portada final, marca el contrato como "completado". Si el acuerdo era un pago fijo, se transfiere el dinero. Si era por regalías, el sistema de A.U.T.O.R. se encargará automáticamente de depositar el 5% de todos los ingresos futuros de esa obra en la cuenta del Diseñador, de forma transparente y perpetua.
   - **Reseña y Reputación:** Al finalizar el contrato, ambas partes pueden dejarse una reseña mutua. Una buena reseña de un autor verificado aumentará la reputación del Diseñador, ayudándole a conseguir más trabajos en el futuro.

   ### Decisiones Arquitectónicas Clave

- **Stack Tecnológico Inicial (Front-End Estático):** Se eligió empezar con HTML, CSS y JavaScript puros (sin frameworks como React o Vue) para construir una base sólida, ligera y fácil de entender, manteniendo los costos en cero.
- **Backend-as-a-Service (BaaS):** Se eligió **Supabase** por las siguientes razones:
    - **Plan Gratuito Generoso:** Cubre todas las necesidades del MVP sin costo alguno.
    - **Base de Datos PostgreSQL:** Es una base de datos relacional estándar y potente, ideal para la estructura de usuarios, historias, capítulos y futuras transacciones.
    - **Autenticación Integrada:** Proporciona un sistema de registro, login y gestión de usuarios seguro y listo para usar, incluyendo la confirmación por email.
    - **Alternativa Open Source:** Ofrece más control y transparencia que otras opciones propietarias.
- **Alojamiento y Despliegue (Futuro):** La estrategia es usar **Netlify** o **Vercel** para el despliegue del front-end, por su integración perfecta con GitHub y sus generosos planes gratuitos.

- **Sistema de Ejecución por Página (Front-End):** Para optimizar la carga y evitar ejecutar código innecesario, se implementó un sistema de "enrutamiento" del lado del cliente. Cada página HTML principal tiene un atributo `data-page` en su etiqueta `<body>` (ej. `<body data-page="perfil">`). El archivo `script.js`, al cargarse, lee este atributo y utiliza una estructura `switch` para ejecutar únicamente las funciones de inicialización requeridas para esa página específica.

### Revisión de la Experiencia de Usuario Inicial (UX v2.0)

Tras la maquetación inicial, se ha decidido refinar la experiencia del primer contacto del usuario con la plataforma para centrarse inmediatamente en el contenido.

*   **Página de Inicio Centrada en el Contenido:** Se elimina la sección "hero" (el gran titular de bienvenida). La página `index.html` ahora mostrará directamente una selección de historias destacadas, sumergiendo al usuario en el catálogo desde el primer segundo.
*   **Barra de Noticias y Eventos:** En la parte superior de la página de inicio, se contempla un nuevo componente para anunciar concursos, eventos de la comunidad o noticias relevantes, fomentando la participación.
*   **Barra de Búsqueda Global:** La funcionalidad de búsqueda deja de ser exclusiva de la página "Explorar". La barra de búsqueda se integrará directamente en el **encabezado (`header`)**, permitiendo al usuario iniciar una búsqueda desde cualquier punto de la web, tal como esperan de una plataforma moderna.

### "Conocimiento Tribal" y Desafíos Inmediatos

- **Problemas de CSS y Caché:** Se experimentaron dificultades significativas con la memoria caché del navegador, que impedían ver los cambios de estilo. La solución estándar es siempre realizar una **Recarga Forzada (`Ctrl+F5` o `Cmd+Shift+R`)** antes de asumir un error en el código.
- **Evolución del Diseño:** El proyecto migró de un tema oscuro inicial a una identidad de marca de tema claro, más elegante y profesional. Los archivos actuales reflejan este nuevo diseño.
- **Próximo Gran Desafío (Backend):** La transición actual de una maqueta a una aplicación real. El siguiente paso crucial es dejar de usar datos de ejemplo (como las tarjetas de historias en el HTML) y empezar a leer y escribir desde la base de datos de Supabase. Esto implica:
    1.  Crear las tablas (`historias`, `capitulos`) en Supabase.
    2.  Modificar la página `explorar.html` para que obtenga la lista de historias desde la base de datos.
    3.  Construir los formularios que permitirán a los autores (una vez logueados) crear estas historias.

- **Reconstrucción del CSS (v5.0):** Tras encontrar numerosos conflictos de responsividad y diseño inconsistente, se tomó la decisión estratégica de reconstruir por completo el archivo `estilos.css`. La nueva versión (v5.0) se estructuró en 5 partes lógicas: Fundamentos, Estructura, Componentes, Páginas de Contenido y, finalmente, una sección unificada de Modo Oscuro y Responsividad. Este enfoque eliminó el código redundante y solucionó los problemas de layout en el `header` y los paneles de gestión en vistas móviles.


### Estrategia de Aplicación Móvil

La creación de una aplicación nativa se contempla como una fase avanzada del proyecto, posterior a la validación y crecimiento de la plataforma web. La estrategia se divide en tres etapas:

1.  **Etapa 1 (Actual): Perfeccionamiento de la Web Responsiva.** El objetivo principal es asegurar que la experiencia de usuario en navegadores móviles sea impecable, cubriendo todas las funcionalidades clave.
2.  **Etapa 2 (Post-Lanzamiento): Implementación de PWA (Progressive Web App).** Mejorar el sitio web actual para que sea "instalable" en la pantalla de inicio de los móviles, pueda funcionar offline y enviar notificaciones, ofreciendo una experiencia muy similar a una app nativa con un costo de desarrollo mucho menor.
3.  **Etapa 3 (Fase de Crecimiento): Desarrollo de la Aplicación Nativa.** Una vez que A.U.T.O.R. demuestre tener una base de usuarios activa y/o genere ingresos, se evaluará la contratación de un equipo o freelancer especializado para el desarrollo de las aplicaciones nativas para iOS y Android.

---

## Parte 2: El Plan de Acción Maestro

**FASE 0: Cimientos y Estrategia**
- [X] Misión 1: Preparar el terreno (Instalar software, crear cuentas).
- [X] Misión 2: Construir el taller digital (Conectar VS Code con GitHub).

**FASE 1: Maquetación y Diseño Visual**
- [X] Misión 3: Estructura Semántica y Navegación.
- [X] Misión 4: Página de Inicio Atractiva.
- [X] Misión 5: Página de Registro.
- [X] Misión 6: Página de Inicio de Sesión.
- [X] Misión 7: Página de Exploración.
- [X] Misión 8: Página de Detalle de Historia.
- [X] Misión 9: Página de Lectura del Capítulo.

**FASE 2: Interactividad del Lado del Cliente**
- [X] Misión 10: Menú Responsivo (Hamburguesa) con JS.
- [X] Misión 11: Validación del Formulario de Registro con JS.
- [X] Misión 12: Validación del Formulario de Login con JS.
- [X] Misión 13: Simulación de Sesión de Usuario con `localStorage`.

**FASE 3: Pulido del Front-End**
- [x] Misión 14: Mejorar la experiencia de usuario y el diseño visual (Tipografía, etc.).
- [x] Misión 15: Implementar Selector de Tema (Modo Claro/Oscuro).
    - [x] Añadir un interruptor en la UI (interfaz de usuario).
    - [x] Usar variables CSS para definir las paletas de colores de ambos temas.
    - [x] Guardar la preferencia del usuario en `localStorage` para que su elección sea recordada.

**FASE 4: Backend y Base de Datos**
- [X] Misión 16: Elegir y configurar la tecnología Backend (Supabase).
- [X] Misión 17: Conectar el Front-End con Supabase (Instalar cliente y configurar claves API).
- [X] Misión 18: Implementar el registro de usuarios reales con Supabase Auth.
- [X] Misión 19: Implementar el inicio de sesión real y la gestión de sesión con Supabase.
- [x] Misión 20: Crear la página de Perfil de Usuario y mostrar datos.
- [x] Misión 21: Diseñar y crear las tablas de la base de datos (perfiles, historias, capitulos).
- [x] Misión 22: Construir el Panel de Gestión de Contenido del Autor.
    - [x] **Sub-misión 22.1 (Evolucionar el Perfil):** Modificar la página `perfil.html` para que obtenga y muestre una lista de las historias creadas por el usuario que ha iniciado sesión. Cada historia en la lista será un enlace a su panel de gestión.
    - [x] **Sub-misión 22.2 (Crear la Estructura):** Crear el nuevo archivo `gestionar-historia.html` con la estructura HTML para: mostrar detalles de la historia, listar capítulos existentes y un formulario para añadir nuevos capítulos.
    - [x] **Sub-misión 22.3 (Dar Vida al Panel):** Implementar la lógica en `script.js` (`cargarPanelDeGestion`) para rellenar la página `gestionar-historia.html` con los datos correctos de la historia y sus capítulos desde Supabase.
    - [x] **Sub-misión 22.4 (Implementar Creación de Capítulos):** Conectar el formulario de "Añadir Nuevo Capítulo" a una función de JavaScript que guarde el nuevo capítulo en la base de datos.
    - [x] **Sub-misión 22.5 (Asegurar el Acceso):** Crear las políticas de seguridad RLS necesarias para permitir que un autor pueda `UPDATE` (actualizar) y `DELETE` (borrar) sus propias historias, y `INSERT` (añadir) capítulos solo a las historias que le pertenecen.
    - [X] **Sub-misión 22.6:** Implementar el borrado de capítulos.
- [X] Misión 23: Implementar Políticas de Seguridad a Nivel de Fila (RLS) para todas las tablas y operaciones, asegurando que los usuarios solo puedan modificar su propio contenido.

**FASE 4.5: Misión de Pulido Final y Comunidad (En Proceso)**
- [X] Misión 24: Completar la funcionalidad del Perfil de Usuario.
    - [X] **Sub-misión 24.1:** Permitir la edición de `username` y `bio`.
    - [X] **Sub-misión 24.2:** Permitir la subida de un `avatar` de perfil a Supabase Storage.
    - [X] **Sub-misión 24.3:** Implementar el borrado de una historia completa (y sus capítulos asociados).
- [X] Misión 25: Refinar la Experiencia de Usuario (UX).
    - [X] **Sub-misión 25.1:** Corregir el diseño de la barra de búsqueda en dispositivos móviles.
    - [X] **Sub-misión 25.2:** Añadir "Estadísticas a la Vista" en el panel de gestión.
    - [X] **Misión 26:** Gestión de Portadas de Historias.
- [X] **Misión 27:** Implementar perfiles de usuario con roles seleccionables (sistema híbrido con roles predefinidos y personalizados).(**Autor, Lector, Editor, Diseñador, Traductor, Crítico, Beta-Reader, etc**).
- [ ] **Misión 28: Implementar Perfiles Públicos.**
    - [X] **Sub-misión 28.1:** Modificar los enlaces de autor en las páginas de historias para que apunten a `perfil.html?id=[ID_DEL_AUTOR]`.
    - [X] **Sub-misión 28.2:** Reconstruir la lógica de `perfil.html` para operar en modo híbrido (vista pública vs. privada).
    - [X] **Sub-misión 28.3:** Cargar y mostrar las obras publicadas de un autor en su perfil público.
    - [X] **Sub-misión 28.4:** Solucionar el "parpadeo" de la interfaz al cargar perfiles públicos.
- [ ] **Misión Intermedia: La Bitácora del Creador (MVP)**
    - [X] **Sub-misión A (Backend):** Crear y asegurar la tabla `bitacora` en Supabase.
    - [X] **Sub-misión B (Creación de Contenido):** Crear la página `crear-entrada.html` con su lógica de formulario dinámico.
    - [X] **Sub-misión C (Visualización):** Añadir la pestaña "Bitácora" al perfil y mostrar las entradas con opción de borrado para el dueño.
    - [ ] **Visión Futura para esta Misión:** Implementar la página de lectura dedicada para los artículos, añadir un sistema de "Seguimiento" de creadores y explorar la monetización por entrada.

**FASE 5: El Gremio - El Mercado de Talentos**
- [ ] **Misión 29:** Construir un sistema de portafolios y de reseñas entre usuarios (ej. un autor reseña al editor).
- [ ] **Misión 30:** Implementar un sistema de búsqueda y filtros para encontrar colaboradores.
- [ ] **Misión 31:** Construir la mensajería interna.
- [ ] **Misión 32:** Implementar sistema de "contratos" simplificados y reparto de ganancias.

**FASE 6: El Ecosistema de Progreso y Comunidad**
- [ ] **Misión 32 (Hub Comunitario):**
    - [ ] Implementar un sistema de foros integrado con perfiles.
    - [ ] Permitir la inserción de contenido externo (YouTube, etc.) en los hilos.
- [ ] **Misión 33 (Sistema de Progreso Global):**
    - [ ] Diseñar y crear la base de datos para los Puntos de Experiencia (XP) y la Moneda Virtual.
    - [ ] **Árbol del Lector:** Implementar la lógica de ganancia de XP/Moneda (leer, comentar, etc.).
    - [ ] **Árbol del Creador (Autores/Gremio):** Implementar la lógica de ganancia de XP (publicar, recibir donaciones, completar trabajos).
- [ ] **Misión: Crear Página de Valor "Para Creadores".**
    - [ ] **Sub-misión A (Diseño de Contenido):** Redactar los textos que explican los beneficios y las oportunidades de monetización para cada rol clave: Autores, Críticos, Editores, Diseñadores, Traductores, etc.
    - [ ] **Sub-misión B (Diseño de Interfaz):** Maquetar el diseño de una nueva página (o una sección principal en el `index`) que presente esta información de forma clara y atractiva.
    - [ ] **Sub-misión C (Implementación):** Construir la página estática y añadir enlaces a ella desde el menú de navegación principal y el pie de página.
- [ ] **Misión: Pulido de la Experiencia de Lectura.**
    - [ ] **Sub-misión A (Página de Capítulo):** Rediseñar la interfaz de lectura para que sea más limpia. Implementar la lógica funcional para los botones "Capítulo Anterior" y "Siguiente Capítulo".
    - [ ] **Sub-misión B (Controles de Accesibilidad):** Añadir botones en la página de capítulo para agrandar o disminuir el tamaño de la letra.
    - [ ] **Sub-misión C (Punto de Lectura):** Implementar un sistema que guarde automáticamente el progreso de lectura de un usuario en una obra y lo lleve de vuelta a ese punto al regresar.
- [ ] **Misión: Potenciar el Editor de Capítulos.**
    - [ ] **Sub-misión A (Editor de Texto Enriquecido):** Reemplazar el `<textarea>` por una librería que permita formato (negrita, cursiva, centrado) e inserción de imágenes en los capítulos, con un límite por capítulo.
    - [ ] **Sub-misión B (Asistentes de Escritura):** Añadir un contador de palabras en tiempo real. Implementar validaciones para un mínimo y máximo de palabras en capítulos (especialmente si son de pago).
- [ ] **Misión: Rediseñar la Página de Inicio (Index).**
    - [ ] **Sub-misión A (Sistema de Seguimiento):** Implementar la funcionalidad para que los usuarios puedan "Seguir" a sus creadores favoritos.
    - [ ] **Sub-misión B (Feed Personalizado):** Para usuarios registrados, la página de inicio se convertirá en un feed de actividad que mezcla capítulos y entradas de la bitácora de los creadores seguidos. Incluir un interruptor para alternar con un feed de "Descubrimiento".
    - [ ] **Sub-misión C (Barra Personal):** Crear un componente de acceso rápido a listas como "Continuar Leyendo" y "Pendientes".

- [ ] **Misión: Potenciar la Bitácora y la Interacción Social.**
    - [ ] **Sub-misión A (Función "Compartir"):** Permitir a los usuarios citar una entrada de la bitácora de otro creador en su propia bitácora, añadiendo su propio comentario.
    - [ ] **Sub-misión B (Especialización para Críticas):** Permitir categorizar "Artículos" como "Críticas", añadiendo campos opcionales como una calificación por estrellas.

- [ ] **Misión: Hacer de "Explorar" una Herramienta Poderosa.**
    - [ ] **Sub-misión A (Sistema de Etiquetas):** Permitir a los autores añadir múltiples etiquetas de género y de "tono/sentimiento" (ej. "Alegre", "Oscuro") a sus obras.
    - [ ] **Sub-misión B (Interfaz de Filtrado Avanzado):** Construir la página de "Explorar" con filtros que permitan combinar estas etiquetas para refinar las búsquedas.
- [ ] **Misión: Gestión Avanzada de Obras.**
    - [ ] **Sub-misión A (Estado de "Borrador" para Historias):** Añadir un `status` a las historias para que puedan existir como borradores privados antes de ser publicadas.
    - [ ] **Sub-misión B (Sagas y Volúmenes):** Reestructurar la base de datos para permitir la creación de "Sagas" que contengan múltiples "Libros" o "Volúmenes", cada uno con sus propios capítulos.
    - [ ] **Sub-misión C (Carga por Lotes):** Crear una herramienta para subir un documento completo y que el sistema lo divida automáticamente en capítulos
- [ ] **Misión 34 (Economía Virtual):**
    - [ ] Construir la "tienda" para gastar monedas.
    - [ ] Implementar recompensas estéticas (marcos, insignias) y funcionales (comentarios destacados).
    - [ ] Construir la **Biblioteca Premium** (colecciones, notas) y su sistema de desbloqueo (pago y con monedas).

**FASE 7: Monetización (La Maquinaria de Ingresos)**
- [ ] Misión A (Pasarela de Pago): Integrar un procesador de pagos como Stripe o Mercado Pago. Esto es un requisito para todo lo demás.
- [ ] Misión B (Donaciones): Implementar la funcionalidad de donación directa al autor (en su perfil) y la micro-donación por párrafo.
- [ ] Misión C (Compra Directa): Construir la lógica para que un usuario pueda pagar para desbloquear una obra completa o un capítulo específico (el Paywall Flexible).
- [ ] Misión D (Suscripciones): Crear el sistema de suscripción mensual, gestionar los pagos recurrentes y los beneficios para suscriptores.
- [ ] Misión E (Publicidad): Esta suele ser una de las últimas fases. Integrar una red publicitaria (como Google AdSense) para mostrar anuncios a los usuarios no suscritos. Los ingresos se registran y se asocian a las obras leídas para el reparto de regalías.
- [ ] **Misión: Monetización de la Bitácora.**
    - [ ] **Sub-misión A (Sistema de "Aplausos"):** Implementar un sistema de micro-donaciones (propinas) para las entradas de la bitácora.
    - [ ] **Sub-misión B (Contenido Exclusivo):** Permitir a los creadores marcar "Artículos" como contenido de pago o exclusivo para suscriptores.



**FASE 8: Internacionalización (Soporte Bilingüe)**
- [ ] Misión A (Traducción de la Interfaz - UI):
    - [ ] Crear archivos de idioma (`es.json`, `en.json`) para todo el texto estático.
    - [ ] Implementar un script que cambie el idioma de la UI dinámicamente.
    - [ ] Añadir un selector de idioma en el `header` o `footer`.
    - [ ] Traducir la interfaz de la plataforma.
    - [ ] Permitir que el contenido (historias, bitácora) sea marcado con un idioma y filtrado por este.
- [ ] Misión B (Soporte de Contenido Multilingüe):
    - [ ] Modificar la tabla `historias` en la base de datos para incluir un campo "idioma".
    - [ ] Actualizar la página "Explorar" para permitir filtrar historias por idioma.
- [ ] Misión C (Traducción Colaborativa - Integración con El Gremio):
    - [ ] Permitir que una obra tenga versiones enlazadas en diferentes idiomas.
    - [ ] Construir la funcionalidad para que un Autor pueda comisionar a un Traductor del Gremio para traducir su obra.

---

## Parte 3: El Estado Técnico

**Configuración Detallada del Backend (Supabase)**

Esta sección documenta el estado actual de la infraestructura en Supabase, diseñada para ser procesada y entendida por cualquier desarrollador o IA (como Gemini 2.5 Pro).

1. Estructura de la Base de Datos (Tablas y Relaciones)
La base de datos PostgreSQL se organiza en las siguientes tablas principales dentro del schema public:

Tabla: profiles
Propósito: Almacena los datos públicos y editables de los usuarios, extendiendo la información del sistema de autenticación.
Estructura de Columnas:
id (uuid, Primary Key): Clave primaria de la tabla.
updated_at (timestamptz): Marca de tiempo de la última actualización.
username (text): Nombre de usuario público y editable.
full_name (text, nullable): Nombre completo del usuario. (Actualmente no se utiliza en los formularios).
avatar_url (text, nullable): URL pública de la imagen de perfil alojada en Supabase Storage.
bio (text, nullable): Biografía del usuario.
Relaciones Clave (Foreign Keys):
La columna profiles.id tiene una relación de clave externa con auth.users.id. Esto es crítico y vincula cada perfil a un usuario de autenticación, garantizando la integridad de los datos.

Tabla: stories
Propósito: Almacena la información principal de cada obra o historia.
Estructura de Columnas:
id (bigint, Primary Key, Identity): Identificador numérico único y autoincremental de la historia.
created_at (timestamz): Marca de tiempo de creación.
title (text): Título de la historia.
synopsis (text): Resumen o sinopsis de la historia.
author_id (uuid): Clave externa que referencia a `profiles.id`, indicando el autor.
cover_image_url (text, nullable): URL de la imagen de portada.
genre (text, nullable): Género de la historia.
*Nota Crítica:* A diferencia de `profiles` y `chapters`, la clave primaria `id` de la tabla `stories` se configuró como `bigint` (serial) en lugar de `uuid`. Esta decisión impactó la creación de las políticas de seguridad de Storage, que tuvieron que ser adaptadas para convertir los nombres de archivo a `bigint` para su comparación.

Tabla: chapters
Propósito: Almacena el contenido de cada capítulo individual, vinculado a una historia.
Estructura de Columnas:
id (uuid, Primary Key): Identificador único del capítulo.
created_at (timestamz): Marca de tiempo de creación.
story_id (bigint): Clave externa que referencia a `stories.id`.
title (text): Título del capítulo.
content (text): Contenido principal del capítulo.
chapter_number (integer): Número de orden del capítulo.
status (text, default: 'borrador'): Estado del capítulo. Puede ser 'borrador' o 'publicado'.

Tabla: bitacora
Propósito: Almacena el contenido editorial de formato corto y largo creado por los usuarios, como apuntes, artículos o críticas.
Estructura de Columnas:
id (bigint, Primary Key, Identity): Identificador numérico único y autoincremental de la entrada.
created_at (timestamptz): Marca de tiempo de creación.
author_id (uuid): Clave externa que referencia a `profiles.id`, indicando el creador de la entrada.
type (text, default: 'apunte'): Define el formato. Puede ser 'apunte' (corto) o 'articulo' (largo).
title (text, nullable): Título de la entrada. Requerido si el `type` es 'articulo'.
content (text, nullable): El cuerpo principal del texto.

2. Autenticación y Automatización (Triggers)

Se ha implementado un trigger a nivel de base de datos para asegurar que cada nuevo usuario tenga un perfil desde el momento de su registro.

Función: public.handle_new_user()
Disparador (Trigger): on_auth_user_created
Evento: Se ejecuta AFTER INSERT ON auth.users.
Acción: Cuando se crea un nuevo usuario en el sistema de autenticación, esta función se dispara e inserta automáticamente una nueva fila en public.profiles. La fila se rellena con el id, username y full_name extraídos de los metadatos del nuevo usuario. Esto es fundamental para que la lógica de "editar perfil" funcione correctamente desde el primer momento.

Código del Trigger:

create function public.handle_new_user()
returns trigger as $$
begin
  insert into public.profiles (id, username, full_name)
  values (new.id, new.raw_user_meta_data->>'username', new.raw_user_meta_data->>'full_name');
  return new;
end;
$$ language plpgsql security definer;

create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();

3. Almacenamiento de Archivos (Supabase Storage)

Se utilizan dos buckets públicos para gestionar los archivos subidos por los usuarios.

Bucket: `avatars`
Acceso: Público. Gestiona las imágenes de perfil de los usuarios. Las políticas de seguridad garantizan que cada usuario solo pueda gestionar (`INSERT`, `UPDATE`, `DELETE`) los archivos dentro de su propia carpeta, nombrada con su `user_id`.

Bucket: `covers`
Acceso: Público. Aloja las portadas de las historias. Se han implementado tres políticas de seguridad a nivel de fila para controlar el acceso:
-   **Política de INSERT (Subida):** Permite a un usuario autenticado subir un archivo solo si el nombre del archivo (sin extensión y convertido a `bigint`) coincide con el `id` de una historia de la cual es autor.
-   **Política de UPDATE (Actualización):** Permite a un usuario autenticado modificar un archivo existente bajo las mismas condiciones de propiedad que el INSERT.
-   **Política de SELECT (Lectura):** Permite el acceso de lectura público (`public`) a todos los archivos del bucket, para que las imágenes puedan ser mostradas en la web.

4. Políticas de Seguridad (Row Level Security - RLS)

RLS está activado en todas las tablas (`profiles`, `stories`, `chapters`, `bitacora`) para garantizar un control de acceso granular y seguro.

Para la tabla `profiles`:
- **SELECT:** Pública. Cualquiera puede leer los perfiles.
- **UPDATE:** Un usuario solo puede actualizar su propio perfil (`auth.uid() = id`).

Para la tabla `stories`:
- **SELECT:** Pública. Cualquiera puede leer las historias.
- **INSERT:** Solo usuarios autenticados.
- **UPDATE / DELETE:** Solo el autor de la historia (`auth.uid() = author_id`).

Para la tabla `chapters`:
- **SELECT:** Cualquiera puede leer un capítulo si su `status` es 'publicado', O si el que lo lee es el autor de la historia (para permitirle ver sus borradores).
- **INSERT / UPDATE / DELETE:** Solo permitido si el `auth.uid()` del usuario coincide con el `author_id` de la historia a la que pertenece el capítulo.

**Para la tabla `bitacora` (NUEVO):**
- **SELECT:** Pública. Cualquiera puede leer todas las entradas de la bitácora.
- **INSERT:** Un usuario autenticado solo puede crear entradas para sí mismo (`auth.uid() = author_id`).
- **UPDATE:** Un usuario solo puede modificar sus propias entradas (`auth.uid() = author_id`).
- **DELETE:** Un usuario solo puede borrar sus propias entradas (`auth.uid() = author_id`).


- **Repositorio de GitHub:** [Pega aquí la URL de tu repositorio de GitHub]
- **Sitio de Pruebas en Netlify:** [Pega aquí la URL que te dio Netlify si decidiste publicar]

- **Estructura de Archivos:**
  proyecto-autor/
  ├── index.html
  ├── registro.html
  ├── login.html
  ├── explorar.html
  ├── historia.html
  ├── capitulo.html
  ├── confirmacion.html
  ├── perfil.html
  ├── gestionar-historia.html 
  ├── estilos.css
  ├── script.js
  └── Manual_AUTOR.md (Este mismo archivo)

- **Guía de Marca (Identidad Visual v2.0):**
  - **Paleta de Colores:**
    - **Fondo Principal:** Blanco Grisáceo (#DDDDDD)
    - **Texto Principal:** Negro Suave (#1a1a1a)
    - **Color de Acento:** Verde Esmeralda (#26DDC6)
    - **Color de Apoyo (Links, etc.):** Gris Oscuro (#333)
  - **Tipografía:**
    - **Títulos y Logo:** 'Playfair Display', serif
    - **Cuerpo de Texto y UI:** 'Roboto', sans-serif
    - **Texto de Lectura Larga:** 'Georgia', serif

    ---

## Historial de Cambios (Changelog)

### Versión 5.1 (Refinamiento Inicial) - Agosto 2025

Se completa la primera fase de refinamiento de código y mejora de la experiencia de usuario antes de proceder con nuevas funcionalidades mayores.

**Mejoras Estructurales:**
*   **Centralización de Componentes:** Se ha refactorizado el código del `Header` y `Footer`. Ahora se gestionan desde archivos `header.html` y `footer.html` y se inyectan dinámicamente en todas las páginas mediante JavaScript. Esto reduce drásticamente la duplicación de código y facilita el mantenimiento.

**Mejoras Funcionales y de UX:**
*   **Editor de Capítulos Reparado:** Se ha implementado por completo la lógica para crear, leer, actualizar y borrar (CRUD) capítulos en la página `editar-capitulo.html`. Se solucionó un bug crítico que impedía la carga de los datos del capítulo.
*   **Navegación de Capítulos Funcional:** Se ha añadido la lógica a la página de lectura (`capitulo.html`) para que los botones "Capítulo Anterior" y "Siguiente Capítulo" funcionen, ocultándose dinámicamente si no hay un capítulo al que navegar.
*   **Feedback en Formularios:** Los formularios de Login y Registro ahora deshabilitan el botón de envío y muestran el texto "Cargando..." al procesar una solicitud, mejorando la retroalimentación al usuario y evitando envíos duplicados.

---